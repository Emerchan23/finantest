{
  "meta": {
    "project": "ERP-BR",
    "date": "2025-09-08",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "ERP-BR is a comprehensive Brazilian Enterprise Resource Planning (ERP) system built with Next.js and Node.js, designed to streamline business management for small and medium-sized companies. It focuses on sales, clients, product management, financial reporting, and multi-tenant capabilities with robust dashboard and backup functionalities.",
  "core_goals": [
    "Provide a complete business management solution tailored for Brazilian companies",
    "Simplify control of sales, inventory, and customer relationships",
    "Automate financial and accounting processes with seamless integration",
    "Deliver real-time metrics and customizable dashboards",
    "Ensure ease of installation, configuration, and daily use",
    "Support multiple independent companies with strict data isolation",
    "Offer secure and reliable data backup and restore capabilities"
  ],
  "key_features": [
    "Multi-tenant company management with independent configuration and personalized branding",
    "Comprehensive client management including detailed records and historical transactions",
    "Product catalog management with categorization, price tracking, and stock control",
    "Full sales system allowing multi-item sales linked to customers and products with automatic total calculations",
    "Budgeting system with customizable layout, PDF generation, and email dispatch",
    "Dynamic dashboards and reports with KPIs, charts, and time filters for business insights",
    "Financial management with receipts, advances (vales), expense sharing (acertos), and pending expenses handling",
    "System health check API for operational monitoring",
    "Backup and restore functionality with JSON export/import and data integrity validation",
    "SMTP email system with dynamic configuration and connection testing",
    "Responsive and accessible user interface powered by Tailwind CSS and Radix UI",
    "Automated installation and environment setup leveraging Docker and environment variables"
  ],
  "user_flow_summary": [
    "First Installation: User runs `npm run setup`, system checks dependencies, installs needed packages, sets up database and environment, then launches application accessible via localhost on port 3145",
    "Create Budget: User navigates to budgets page, creates new budget by selecting or adding client, adds product items with quantities, reviews and customizes layout, saves budget, and optionally sends via email",
    "Make Sale: User accesses sales page, initiates new sale, selects client, adds products and quantities, confirms values, system registers sale and updates dashboard metrics accordingly",
    "Manage Companies: User creates and switches between multiple companies, customizing each with distinct branding and fiscal settings, ensuring data separation",
    "Send Email: User configures SMTP settings, tests connection, composes and sends emails such as budget dispatches",
    "Backup & Restore: User exports current system data to JSON for backup, imports data for restoration or merging with validation"
  ],
  "validation_criteria": [
    "All CRUD operations for companies, clients, products, sales, budgets, expenses, and financial adjustments function correctly with multi-tenant data isolation",
    "System maintains response times under 2 seconds for standard operations and handles up to 10,000 records per table without degradation",
    "Dashboard displays accurate and updated KPIs and reports with interactive filters",
    "Budget creation supports layout customization, PDF generation, and email sending with proper SMTP configuration and error handling",
    "Backup and restore operations correctly export and import data preserving integrity and allowing merge or replace options",
    "Email system validates SMTP connections successfully and sends emails without failure",
    "User interface is responsive, accessible with keyboard navigation and feedback mechanisms",
    "System passes health check API returning application status and timestamp",
    "Installation completes automatically in under 5 minutes with environment variables configurability and Docker support",
    "Security measures including input validation, SQL sanitization, CORS configuration, and audit logging are in place and effective"
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 15.2.4",
      "React 19",
      "SQLite",
      "Better-SQLite3",
      "Tailwind CSS",
      "Radix UI",
      "Shadcn/ui",
      "Node.js",
      "Docker",
      "Nodemailer"
    ],
    "features": [
      {
        "name": "Health Check API",
        "description": "Endpoint para verificar status da aplicação",
        "files": [
          "app/api/health/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/health": {
              "get": {
                "summary": "Health check endpoint",
                "responses": {
                  "200": {
                    "description": "Application is healthy",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "ok": {
                              "type": "boolean"
                            },
                            "timestamp": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Gestão de Empresas",
        "description": "CRUD completo para empresas com suporte multi-tenant",
        "files": [
          "app/api/empresas/route.ts",
          "app/api/empresas/[id]/route.ts",
          "app/api/empresa-config/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/empresas": {
              "get": {
                "summary": "Listar todas as empresas",
                "responses": {
                  "200": {
                    "description": "Lista de empresas",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "nome": {
                                "type": "string"
                              },
                              "created_at": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "post": {
                "summary": "Criar nova empresa",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "nome": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Empresa criada",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Gestão de Clientes",
        "description": "CRUD completo para clientes com isolamento por empresa",
        "files": [
          "app/api/clientes/route.ts",
          "app/api/clientes/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/clientes": {
              "get": {
                "summary": "Listar clientes da empresa atual",
                "responses": {
                  "200": {
                    "description": "Lista de clientes",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "nome": {
                                "type": "string"
                              },
                              "documento": {
                                "type": "string"
                              },
                              "endereco": {
                                "type": "string"
                              },
                              "telefone": {
                                "type": "string"
                              },
                              "email": {
                                "type": "string"
                              },
                              "createdAt": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "post": {
                "summary": "Criar novo cliente",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "nome": {
                            "type": "string"
                          },
                          "documento": {
                            "type": "string"
                          },
                          "endereco": {
                            "type": "string"
                          },
                          "telefone": {
                            "type": "string"
                          },
                          "email": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Cliente criado",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Gestão de Produtos",
        "description": "CRUD completo para produtos com isolamento por empresa",
        "files": [
          "app/api/produtos/route.ts",
          "app/api/produtos/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/produtos": {
              "get": {
                "summary": "Listar produtos da empresa atual",
                "responses": {
                  "200": {
                    "description": "Lista de produtos",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "nome": {
                                "type": "string"
                              },
                              "preco": {
                                "type": "number"
                              },
                              "categoria": {
                                "type": "string"
                              },
                              "created_at": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "post": {
                "summary": "Criar novo produto",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "nome": {
                            "type": "string"
                          },
                          "preco": {
                            "type": "number"
                          },
                          "categoria": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Produto criado",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Gestão de Vendas",
        "description": "Sistema completo de vendas com relacionamento entre clientes, produtos e empresas",
        "files": [
          "app/api/vendas/route.ts",
          "app/api/vendas/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/vendas": {
              "get": {
                "summary": "Listar vendas com dados relacionados",
                "responses": {
                  "200": {
                    "description": "Lista de vendas",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "cliente_id": {
                                "type": "string"
                              },
                              "produto_id": {
                                "type": "string"
                              },
                              "quantidade": {
                                "type": "number"
                              },
                              "preco_unitario": {
                                "type": "number"
                              },
                              "total": {
                                "type": "number"
                              },
                              "empresa_id": {
                                "type": "string"
                              },
                              "cliente_nome": {
                                "type": "string"
                              },
                              "produto_nome": {
                                "type": "string"
                              },
                              "empresa_nome": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "post": {
                "summary": "Criar nova venda",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "cliente_id": {
                            "type": "string"
                          },
                          "produto_id": {
                            "type": "string"
                          },
                          "quantidade": {
                            "type": "number"
                          },
                          "preco_unitario": {
                            "type": "number"
                          },
                          "empresa_id": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Venda criada",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Sistema de Orçamentos",
        "description": "Criação e gestão de orçamentos com itens e envio por email",
        "files": [
          "app/api/orcamentos/route.ts",
          "app/api/orcamentos/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/orcamentos": {
              "get": {
                "summary": "Listar orçamentos",
                "parameters": [
                  {
                    "name": "incluir_itens",
                    "in": "query",
                    "schema": {
                      "type": "boolean"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Lista de orçamentos"
                  }
                }
              },
              "post": {
                "summary": "Criar novo orçamento",
                "responses": {
                  "200": {
                    "description": "Orçamento criado"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Sistema de Email",
        "description": "Envio de emails via SMTP com configuração dinâmica",
        "files": [
          "app/api/email/send/route.ts",
          "app/api/email/test-connection/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/email/send": {
              "post": {
                "summary": "Enviar email",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "to": {
                            "type": "string"
                          },
                          "subject": {
                            "type": "string"
                          },
                          "html": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Email enviado com sucesso"
                  }
                }
              }
            },
            "/api/email/test-connection": {
              "post": {
                "summary": "Testar conexão SMTP",
                "responses": {
                  "200": {
                    "description": "Conexão testada"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Dashboard e Relatórios",
        "description": "APIs para dashboard com métricas, alertas e séries temporais",
        "files": [
          "app/api/dashboard/summary/route.ts",
          "app/api/dashboard/totals/route.ts",
          "app/api/dashboard/alerts/route.ts",
          "app/api/dashboard/series/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/dashboard/summary": {
              "get": {
                "summary": "Resumo do dashboard",
                "responses": {
                  "200": {
                    "description": "Dados de resumo"
                  }
                }
              }
            },
            "/api/dashboard/totals": {
              "get": {
                "summary": "Totais do dashboard",
                "responses": {
                  "200": {
                    "description": "Dados de totais"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Sistema de Backup",
        "description": "Exportação e importação de dados do sistema",
        "files": [
          "app/backup/export/page.tsx",
          "app/backup/import/page.tsx"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/backup/export": {
              "get": {
                "summary": "Exportar dados do sistema",
                "responses": {
                  "200": {
                    "description": "Dados exportados"
                  }
                }
              }
            },
            "/backup/import": {
              "post": {
                "summary": "Importar dados para o sistema",
                "responses": {
                  "200": {
                    "description": "Dados importados"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Gestão de Despesas Pendentes",
        "description": "CRUD para despesas pendentes",
        "files": [
          "app/api/despesas-pendentes/route.ts",
          "app/api/despesas-pendentes/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/despesas-pendentes": {
              "get": {
                "summary": "Listar despesas pendentes",
                "responses": {
                  "200": {
                    "description": "Lista de despesas pendentes"
                  }
                }
              },
              "post": {
                "summary": "Criar despesa pendente",
                "responses": {
                  "200": {
                    "description": "Despesa criada"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Sistema de Acertos",
        "description": "Gestão de acertos financeiros",
        "files": [
          "app/api/acertos/route.ts",
          "app/api/acertos/[id]/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "paths": {
            "/api/acertos": {
              "get": {
                "summary": "Listar acertos",
                "responses": {
                  "200": {
                    "description": "Lista de acertos"
                  }
                }
              },
              "post": {
                "summary": "Criar acerto",
                "responses": {
                  "200": {
                    "description": "Acerto criado"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
